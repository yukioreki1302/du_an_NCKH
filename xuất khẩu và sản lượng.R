# Bu???c 1: Cài d???t các thu vi???n c???n thi???t (n???u chua cài)
install.packages("readxl")
install.packages("ggplot2")

# Bu???c 2: T???i các thu vi???n dã cài d???t
library(readxl)
library(ggplot2)

# Bu???c 3: D???c d??? li???u t??? file Excel
file_path <- "C:/Users/admin/OneDrive/Documents/New folder (3)/OneDrive/Desktop/du an/xu???t kh???u và s???n lu???ng vi???t nam.xlsx"  # Thay d???i thành du???ng d???n th???c t??? t???i file c???a b???n
data <- read_excel(file_path)

# Ki???m tra c???u trúc d??? li???u sau khi d???c
print(head(data))

# Bu???c 4: Chu???n b??? d??? li???u
data$xuatkhau_usd <- as.numeric(gsub(",", "", data[[3]]))  # C???t 3 là c???t xu???t kh???u USD
data$sanluong_tan <- as.numeric(gsub(",", "", data[[4]]))  # C???t 4 là c???t s???n lu???ng t???n

# T???o b???ng riêng cho xu???t kh???u và s???n lu???ng
data_xuatkhau <- data.frame(Year = data$year, Export_Value = data$xuatkhau_usd)
data_sanluong <- data.frame(Year = data$year, Production = data$sanluong_tan)

# Bu???c 5: V??? bi???u d??? giá tr??? xu???t kh???u
ggplot(data_xuatkhau, aes(x = Year, y = Export_Value / 1e6)) +
  geom_line(color = 'red', size = 1.2) +
  geom_point(size = 3, color = 'red', fill = 'white', shape = 21, stroke = 1) +
  labs(title = 'Giá tr??? xu???t kh???u cà phê c???a Vi???t Nam (2017-2023)',
       x = 'Nam',
       y = 'Giá tr??? xu???t kh???u (tri???u USD)') +
  scale_y_continuous(labels = scales::comma_format(scale = 1e6)) +  # D???nh d???ng tr???c y
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, size = 18, face = "bold"),
    axis.title.x = element_text(size = 14),
    axis.title.y = element_text(size = 14),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_line(color = "lightgrey", linetype = "dashed")
  )

# Bu???c 6: V??? bi???u d??? s???n lu???ng
ggplot(data_sanluong, aes(x = Year, y = Production / 1e3)) +
  geom_line(color = 'blue', size = 1.2) +
  geom_point(size = 3, color = 'blue', fill = 'white', shape = 21, stroke = 1) +
  labs(title = 'S???n lu???ng cà phê c???a Vi???t Nam (2017-2023)',
       x = 'Nam',
       y = 'S???n lu???ng (nghìn t???n)') +
  scale_y_continuous(labels = scales::comma_format(scale = 1e3)) +  # D???nh d???ng tr???c y
  theme_minimal() +
  theme(
    plot.title = element_text(hjust = 0.5, size = 18, face = "bold"),
    axis.title.x = element_text(size = 14),
    axis.title.y = element_text(size = 14),
    panel.grid.minor = element_blank(),
    panel.grid.major = element_line(color = "lightgrey", linetype = "dashed")
  )

