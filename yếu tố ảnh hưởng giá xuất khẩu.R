# Bu???c 0: Cài d???t và t???i các thu vi???n c???n thi???t
install.packages("ggplot2")  # Ch??? c???n ch???y m???t l???n
install.packages("readxl")   # Cài d???t thu vi???n d??? d???c file Excel
library(ggplot2)
library(readxl)

# Bu???c 1: D???c d??? li???u t??? file Excel
data <- read_excel("C:/Users/admin/OneDrive/Documents/New folder (3)/OneDrive/Desktop/du an/gia xuat khau.xlsx")  # D???c d??? li???u t??? file Excel

# Ki???m tra d??? li???u
print("D??? li???u ban d???u:")
head(data)

# Bu???c 1: Ki???m tra phân ph???i chu???n
shapiro_test_results <- lapply(data[-1], shapiro.test)  # Th???c hi???n ki???m tra Shapiro-Wilk cho các bi???n

# In k???t qu??? ki???m tra phân ph???i chu???n
print("K???t qu??? ki???m tra phân ph???i chu???n (p-value):")
shapiro_test_results

# Bu???c 2: Chuy???n d???i d??? li???u sang logarit
log_data <- log(data[-1])  # Chuy???n d???i t???t c??? các bi???n (tr??? bi???n nam) sang logarit

# Thêm c???t nam vào d??? li???u dã chuy???n d???i
log_data <- cbind(Year = data$Year, log_data)

# In k???t qu??? log_data
print("D??? li???u sau khi chuy???n d???i sang logarit:")
head(log_data)

# Ki???m tra tên các c???t trong log_data
print("Tên các c???t trong log_data:")
print(names(log_data))

# Bu???c 3: Xây d???ng mô hình h???i quy tuy???n tính
model <- lm(log_data[,2] ~ log_data[,3] + log_data[,4] + log_data[,5])  # S??? d???ng ch??? s??? thay vì tên c???t

# Tóm t???t mô hình
print("Tóm t???t mô hình h???i quy:")
summary(model)

# V??? bi???u d??? h???i quy
ggplot(log_data, aes(x = log_data[,3], y = log_data[,2])) +  # S??? d???ng ch??? s??? cho các c???t
  geom_point() + 
  geom_smooth(method = "lm", se = FALSE, color = "blue") +
  labs(title = "Bi???u d??? h???i quy gi???a xu???t kh???u cà phê Vi???t Nam và Brazil",
       x = "Xu???t kh???u cà phê Brazil (log)",
       y = "Xu???t kh???u cà phê Vi???t Nam (log)")

# Bu???c 4: Phân tích h??? s??? h???i quy
coefficients <- summary(model)$coefficients  # L???y h??? s??? h???i quy t??? mô hình

# In h??? s??? h???i quy
print("H??? s??? h???i quy:")
coefficients

